## 늪에서 빠져 나오기

1년동안 신규 모바일 게임을 개발하면서 사용한 프로그래밍 실천법 경험담 공유

표준화된 프로세스를 도입하려는 노력들

- 애자일 (XP, 스크럼, TDD, 칸반 etc)

그러나..

Specification By Example

### 도움을 받았던 실천법들

- 프로토타이핑
- Domain Model
- 정적 분석
- TDD

### 프로토타이핑

> 올바른 제품을 만드는 일과 제품을 올바르게 만드는 일은 다른 것이다.

프로토타입으로 알고 싶은 것들

- 기술적으로 가능한가? 구현하려면 어떤 기술이 필요한가?
- 만들 가치가 있을까?

아무리 세세한 기획서라도, 모든 요구사항을 잡을 순 없고,
나는 만들면서 배운다. (만들면서 더 똑똑해진다.)

- 코드 중복에 대해서 신경쓰지 않았고
- 가짜 데이터로 작업했으며
- Null 체크 등도 하지 않았다.
- 앞서 언급한 두 조건에만 관심을 가졌다.


대신, 프로토타이핑으로 배운지식을 잘 갈무리해야 한다.
프로토타이핑은 배우기 위해 만들기 때문이다. 배우고자 하는것은,

**만들 수 있는가**, **만들 가치가 있는가**

### 제품 코드 만들기

> 제품을 올바르게 만드는 일

프로토타입을 너무 잘 만들면 버리기 아까워진다. 잘못된 판단을 하게 된다.
(3개월에 이만큼 만들었으니, 6개월이면 게임 나오겠네.)

(경험적으로) 일반적으로 3개월의 프로토타입이면 9개월은 필요하다.

정확하지 않고, 완전하지도, 안전하지도. 보기도 힘든 코드. 이런 코드를 사용하면,

> 프로토타입 코드를 제품코드에 사용하면, 레거시 코드로 작업하는 느낌. 멘탈을 소모한다.
> 주의력, 의지력은 모두 소모성 자원이다.

프로젝트 후반으로 갈 수록 멘탈은 깎여나가며, 기존코드에 기능을 추가하는일은 고통스럽고,
코드베이스를 갈아엎으면 프로젝트가 지연.

따라서 프로토타입 코드를 제품에 쓰는건 **정말로** 위험하다.

> 프로토타이핑에서 배운 지식을 바탕으로 Monolithic Code 를 Clean Code 로 설계

#### 요구사항이 추가될 때 마다 코드가 난잡해진다 !?!?!

> 도메인 모델을 잘못 만들었기 때뭉니다.

디버프, 광역스킬 등등을 추가할때 마다 코드가 점점 복잡해진다.

CMapTools 을 이용해서 Knowledge Modeling 을 시작했다.
UML 은 사용하지 않았다.

#### 모델을 잘 짜면

- 4만라인이 될 뻔 했으나, 2300 라인정도로 관리.
- 도메인 지식을 SkillData 로 분리. 이것은 기획자가 관리.

> 도메인의 복잡성을 설계에서 ㅈ대로 다루지 않으면, 기반지식을 이해해도 무영지물일 것이다. - DDD

#### 프로토타입코드를 제품 코드로 만들려면

- 도메인 모델을 잘 설계해서 분리해야 한다.

### 쾌속 개발

- 이름이 맘에 안들어. 네이버사전검색
- 이거 널 체크해야하는데
- LinQ 쓸까
- 성능이 느린거 아냐? 인터넷 확인해봊
- 트위터 킨다

#### 프로그래밍 멘탈 모델

다른 직업에 비유하면

- 편집자의 뇌: 리팩토링, 최적화의 뇌
- 작가의 뇌 : 구현의 노ㅚ

사람의머리는 싱글코어. 멀티태스킹이 아니라, 태스크 스위칭이다.
몰입에 15분 이상이 걸리므로, 한번에 하나의 일만 하는 것이 효율이 좋다.
(미국에서 작가들에 대해 비교연구를 한 적이 있음)

- 아마추어작가 : 기획 10%, 글쓰기 80%, 퇴고 10%, 평균퇴고 0.8회
- 프로작가: 기획 10%, 글쓰기 20%, 퇴고 70%, 평균 퇴고 18회

비문이 되었든 뭐가 되었든 계속 써내려가고, 그것을 나중에 고침.

> 완벽한 코드는 처음부터 나오지 않는다.

그러면 대강 짜고, 내 코드를 누군가가 확인해 줬으면 좋겠다.

- 표준(Convention)에 맞는지, 중복이 있는지

직업작가에게는 편집자가 있음.

프로그래머에게는 편집자가 있을까? 바로 **정적 분석 툴**

#### 쾌속개발을 위한 프로그래밍 습관

- 돌아가는걸 빨리 짜고
- 정적분석으로 검토
- 지적받은 사항을 고침

#### 중복은요?

중복도 툴을 이용해서 제거할 수 있다. 그렇게 되면

- 이전: 적당히 감으로 시작
- 이후: 중복이 많은곳에서 리패토링을 시작

#### 정적분석 툴 Summary

- 완벽한 코드는 한번에 나오지 않는다.
- 코드의 편집자, 정적분석툴의 도움을 많이 받자.

### Unit Test

- 테스트하기 위해서는 기능을 쪼개야만 했고, 이것은 곧 설계하는 방식이었다.
- 테스트를 작성하는것은 내가 작성한 코드를, 남이 어떻게 쓸까 고민하게 도와준다.

> 테스트 함수 이름을 한글로 작성하니, 테스트가 기능명세가 되어갔다. (Living Documentation)

> https://www.relishapp.com/relish/relish/docs/living-documentation

- 기획문서는 존재하지만, 어떻게 구현했는지는 코드 산출물밖에 없으며
- 그 과정에서 왜 List 가 아니라 HashSet 을 썼는지는 해당 개발자의 머리속에 밖에 없다.
- 암묵적인 지식이 코드에 들어가 있으며, 문서가 없으면 구전으로 전해줘야 한다.

> 시스템고고학: 코드에서 기능을 뽑아내는 프로세스. - Specification By Example

코드가 유일한 단서라면, **적응기간이 길어지고** **잘못 구현이라도 비판없이 받아들이게 된다**

**만약 구현과 함께 성장하는 문서가 있다면?**

#### 신입에게 Test 프로젝트를 알려주었을 때

- 컨벤션에 익숙해지고
- 기능과 의도를 파악하고
- 신입이 테스트를 작성하면 커버리지가 높아지고


#### Living Documentation

기능을 유지하면서 코드를 변경하는데 도움을 준다. 보통 코드 변경은

- 리팩토링
- 최적화
- 외부변화에 대응 (OS, SDK version up)

> 테스트로 Living Documentation 을 만들면, 코드를 변경해도 기능이 동작함을 보장한다.

#### Summary

테스트는

- 설계 방법이자
- Living Documentation
- 신입을 도와준다.
